let wrapper p !crupt toZ frZ !toF frF !toA frA k bits =
  if crupt then
       loop frZ !($\lambda$ _ . error "fail")
    $\xFork$ loop frF !($\lambda$ x . wr x $->$ toA)
    $\xFork$ loop frA !($\lambda$ x . wr x $->$ toF)
  else
    p toZ frZ !toF frF