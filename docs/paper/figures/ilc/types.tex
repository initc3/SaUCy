\begin{figure*}[h]
\centering
\judgbox{\Delta_{in} ; \Gamma |- e : U ; \Delta_{out}}{~~Under input contexts $\Delta_{in}$ and
  $\Gamma$, expression~$e$ has type $U$ and output context $\Delta_{out}$.}
\begin{mathpar}
\Infer{a-var}
{}
{\Delta; \Gamma, x : A |- x : A ; \Delta}
%
\and
%
\Infer{a-avar}
{ }
{\Delta, x : X; \Gamma |- x : X ; \Delta}
%
\and
%
\Infer{a-bang}
{\emptyctxt ; \Gamma |- e : A ; \emptyctxt}
{\Delta ; \Gamma |- \eBang{e} : \tyBang{A} ; \Delta}
%
\and
%
\Infer{a-unbang}
{\Delta_1 ; \Gamma |- e : \tyBang{A} ; \Delta_2}
{\Delta_1 ; \Gamma |- \eUnbang{e} : A ; \Delta_2}
%
\and
%
\Infer{a-unit}
{ }
{\Delta ; \Gamma |- \eUnit : \tyUnit ; \Delta}
%
\and
%
\Infer{a-pair}
{\Delta_1; \Gamma |- e_1 : U_1 ; \Delta_2\\\\
\Delta_2; \Gamma |- e_2 : U_2 ; \Delta_3}
{\Delta_1; \Gamma |- \ePair{e_1}{e_2} : \tyProdd{\pi}{U_1}{U_2} ; \Delta_3}
%
\and
%
\Infer{a-inj}
{i \in \{1, 2\}\\\\
\Delta_1; \Gamma |- e : A_i ; \Delta_2}
{\Delta_1 ; \Gamma |- \eInj{i}{e} : \tySum{A_1}{A_2} ; \Delta_2}
%
\and
%
\Infer{a-ref}
{\Delta_1; \Gamma |- e : A ; \Delta_2}
{\Delta_1; \Gamma |- \eRef{e} : \tyRef{A} ; \Delta_2}
%
\and
%
\Infer{a-split}
{\Delta_1; \Gamma |- e_1 : \tyProd{U_1}{U_2} ; \Delta_2\\\\
[\Delta_2; \Gamma],x_1:U_1, x_2: U_2 |- e : V ; \Delta_3}
{\Delta_1; \Gamma |- \eSplit{e_1}{x_1}{x_2}{e_2} : V ; \Delta_3}
%
\and
%  
\Infer{a-case}
{\Delta_1; \Gamma |- e : \tySum{A_1}{A_2} ; \Delta_2\\\\
\Delta_2; \Gamma,x_1:A_1 |- e_1 : U ; \Delta_3\\\\
\Delta_2; \Gamma,x_2:A_2 |- e_2 : U ; \Delta_3}
{\Delta_1; \Gamma |- \eCase{e}{x_1}{e_1}{x_2}{e_2} : U ; \Delta_3}
%
\and
%
\Infer{a-get}
{\Delta_1, \wrtok; \Gamma |- e : \tyRef{A} ; \Delta_2}
{\Delta_1, \wrtok; \Gamma |- \eGet{e} : A ; \Delta_2}
%
\and
%
\Infer{a-set}
{\Delta_1, \wrtok; \Gamma |- e_1 : \tyRef{A} ; \Delta_2\\\\
\Delta_2; \Gamma |- e_2 : A ; \Delta_3}
{\Delta_1, \wrtok; \Gamma |- \eSet{e_1}{e_2} : \tyUnit ; \Delta_3}
%
\and
%
\Infer{a-fix}
{\emptyctxt; \Gamma,x : \tyArr{U}{\pi}{U} |- e : \tyArr{U}{\pi}{U} ; \emptyctxt}
{\Delta; \Gamma |- \eFixx{\pi}{x}{e} : \tyArr{U}{\pi}{U} ; \Delta}
%
\and
%
\Infer{a-let}
{\Delta_1; \Gamma |- e_1 : U ; \Delta_2\\\\
[\Delta_2; \Gamma], x:U |- e_2 : V ; \Delta_3}
{\Delta_1; \Gamma |- \eLet{x}{e_1}{e_2} : V ; \Delta_3}
%
\and
%
\Infer{a-abs}
{\emptyctxt ; \Gamma, x:A |- e : U ; \emptyctxt}
{\Delta ; \Gamma |- \eLamm{\infty}{x}{e} : A -> U ; \Delta}
%
\and
%
\Infer{a-lolli}
{\emptyctxt; \Gamma |- e : U ; \emptyctxt}
{\Delta ; \Gamma |- \eLamm{1}{x}{e} : X \multimap U ; \Delta}
%
\and
%
\Infer{a-app}
{\Delta_1; \Gamma |- e_2 : U ; \Delta_2\\\\
\Delta_2; \Gamma |- e_1 : U {->}_{\pi} V ; \Delta_3}
{\Delta_1; \Gamma |- \eApp{e_1}{e_2} : V ; \Delta_3}
%
\and
%
\Infer{a-nu}
{\Delta_1, x_1: \tyRd{S} ; \Gamma, x_2 : \tyWr{S} |- e : A ; \Delta_2}
{\Delta_1; \Gamma |- \eNu{(x_1, x_2)}{e} : A; \Delta_2}
%
\and
%
\Infer{a-wr}
{\emptyctxt; {\Gamma}_S |- e_1 : S ; \emptyctxt\\
\Delta_1; \Gamma |- e_2 : \tyWr{S} ; \Delta_2}
{\Delta_1, \wrtok; \Gamma|- \eWr{e_1}{e_2} : \tyUnit; \Delta_2}
%
\and
%
\Infer{a-rd}
{\Delta_1 ; \Gamma |- e : \tyRd{S} ; \Delta_2}
{\Delta_1 ; \Gamma |- \eRd{e} : \tyTensor{\tyBang{S}}{\tyRd{S}}; \Delta_2, \wrtok}
%
\and
%
\Infer{a-fork}
{\Delta_1; \Gamma |- e_1 : U ; \Delta_2\\\\
\Delta_2; \Gamma |- e_2 : V ; \Delta_3}
{\Delta_1; \Gamma |- \eFork{e_1}{e_2} : V ; \Delta_3}
%
\and
%
\Infer{a-choice}
{\Delta_1; \Gamma |- e_1 : U ; \Delta_2\\\\
\Delta_1; \Gamma |- e_2 : U ; \Delta_2}
{\Delta_1; \Gamma |- \eChoice{e_1}{e_2} : U ; \Delta_2}
\end{mathpar}
\caption{Algorithmic typing rules.}
\label{fig:type-expressions}
\end{figure*}
