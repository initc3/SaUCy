\begin{figure*}
  \begin{grammar}
    Expressions
    & $e$
        &$\bnfas$&
        $\eKGen{e} \bnfalt \eTdp{e_1}{e_2} \bnfalt \eInv{e_1}{e_2}
    \bnfalt \eHc{e}$
  \end{grammar}
  
  \judgbox{\Delta ; \Gamma |- e : U}{~~Under affine context $\Delta$ and intuitionistic context
    $\Gamma$, expression~$e$ has intuitionistic type $U$.}
  \begin{mathpar}
  \Infer{kgen}
  {\Delta ; \Gamma |- e : [\tyBit]}
  {\Delta; \Gamma |- \eKGen{e}: \tyProdd{}{[\tyBit]}{[\tyBit]}}
  %
  \and
  %
  \Infer{tdp}
  {\Delta_1; \Gamma |- e_1 : [\tyBit]\\
   \Delta_2; \Gamma |- e_2 : [\tyBit]}
  {\Delta_1, \Delta_2; \Gamma |- \eTdp{e_1}{e_2}: [\tyBit]}
  %
  \and
  %
  \Infer{inv}
  {\Delta_1; \Gamma |- e_1 : \tyProdd{}{[\tyBit]}{[\tyBit]}\\
   \Delta_2; \Gamma |- e_2 : [\tyBit]}
  {\Delta_1, \Delta_2; \Gamma |- \eInv{e_1}{e_2}: [\tyBit]}
  %
  \and
  %
  \Infer{hc}
  {\Delta; \Gamma |- e : \tyArr{[\tyBit]}{}{\tyBit}}
  {\Delta; \Gamma |- \eHc{e}: \tyBit}
  \end{mathpar}
  
  \judgbox{e_1 ---> e_2}{~~Expression~$e_1$ reduces to~$e_2$.}
  \begin{mathpar}
  \Infer{kgen}
  {\keyword{\textbf{Gen}}(v_r) = {(v_{pk}, v_{td})}_{\infty} \\ v_{pk}, v_{td} \in \{0,1\}^k}
  {\eKGen{v_r} ---> {(v_{pk}, v_{td})}_{\infty}}
  \and
  \Infer{tdp}
  {\mathbf{f}({v_{pk}},v_{in}) = v_{out} \\ \mathbf{f} \colon \{0,1\}^k -> \{0,1\}^k -> \{0,1\}^k}
  {\eTdp{v_{pk}}{v_{in}} ---> v_{out} }
  \and
  \Infer{inv}
  {\mathbf{Inv}({(v_{pk}, v_{td})}_{\infty}, v_{in}) = v_{out} \\ \mathbf{Inv} \colon \{0,1\}^k \times
    \{0,1\}^k -> \{0,1\}^k -> \{0,1\}^k}
  {\eInv{{(v_{pk}, v_{td})}_{\infty}}{v_{in}} ---> v_{out} }
  \and
  \Infer{hc}
  {\keyword{\textbf{B}}(v_{pk}) = v \\ \keyword{\textbf{B}} \colon \{0,1\}^k
    -> \{0, 1\}}
  {\eHc{v_{pk}} ---> v}
  \end{mathpar}
  \caption{Extending ILC with trapdoor permutations. The semantics are
    parameterized by a security parameter $k$.}
  \label{fig:extended-ilc}
\end{figure*}
